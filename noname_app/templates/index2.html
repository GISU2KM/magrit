<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>{{ app_name }} - Put your data on the map !</title>

    <link href="/static/css/bootstrap.min.css" rel="stylesheet">
    <link href="/static/css/style-index.css" rel="stylesheet">
    <script src="/static/js/lib/jquery-2.2.1.min.js"></script>
    <script src="/static/js/lib/i18next.min.js"></script>
    <script src="/static/js/lib/loc-i18next.min.js"></script>
    <script src="/static/js/lib/i18nextXHRBackend.min.js"></script>
    <script src="/static/js/lib/bootstrap.min.js"></script>
    <script src="/static/js/lib/jquery.easing.min.js"></script>
    <script src="/static/js/lib/cookies.min.js"></script>

</head>

<!-- The #page-top ID is part of the scrolling feature - the data-spy and data-target are part of the built-in Bootstrap scrollspy function -->

<body id="page-top" data-spy="scroll" data-target=".navbar-fixed-top">

    <!-- Navigation -->
    <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
        <div class="container">
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand page-scroll" href="#page-top"><img src="/static/img/magrit.png" alt="Export" width="auto" height="20"></a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse navbar-ex1-collapse">
                <ul class="nav navbar-nav">
                    <!-- Hidden li included to remove active class from about link when scrolled up past about section -->
                    <li class="hidden">
                        <a class="page-scroll" href="#page-top"></a>
                    </li>
                    <li>
                        <a class="page-scroll i18n" href="#overview" data-i18n="[html]index.buttons.overview"></a>
                    </li>
                    <li>
                        <a class="page-scroll i18n" href="#examples" data-i18n="[html]index.buttons.examples"></a>
                    </li>
                    <li>
                        <a class="page-scroll i18n" href="#projections" data-i18n="[html]index.buttons.projections"></a>
                    </li>
                    <li>
                        <a class="page-scroll i18n" href="#documentation" data-i18n="[html]index.buttons.doc"></a>
                    </li>
                    <li>
                        <a class="page-scroll i18n" href="#source" data-i18n="[html]index.buttons.dev"></a>
                    </li>
                </ul>
                <a class="btn btn-default enter_button i18n" style="float:right;color:greenyellow;background:transparent none repeat scroll 0% 0% border-box;margin-top:7px;" data-i18n="[html]index.buttons.start_now"></a>
                <div class="btn-group" style="float:right;margin-top:7px;";>
                    <button id="lang_current" type="button" class="btn btn-default" style="color:greenyellow;background:transparent none repeat scroll 0% 0% border-box;"></button>
                    <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" style="color:greenyellow;background:transparent none repeat scroll 0% 0% border-box;">
                        <span class="caret"></span>
                    </button>
                    <ul class="dropdown-menu" role="menu">
                        <li><a id="lang1"></a></li>
                        <li><a id="lang2"></a></li>
                    </ul>
                    </div>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </div>
    </nav>

    <section id="intro" class="intro-section">
        <div class="container">
            <div class="row">
            <h1 style="font-family:Dosis;">Magrit - Online mapping application</h1>
            <hr class="grad-transp"></hr>
                <div class="col-md-2"></div>
                <div class="col-md-8">
                    <p style="text-align:left;">
                        <span class="i18n" data-i18n="[html]index.intro_section.arg1"></span><br>
                        <span class="i18n" data-i18n="[html]index.intro_section.arg2"></span><br>
                        <span class="i18n" data-i18n="[html]index.intro_section.arg3"></span><br>
                        <span class="i18n" data-i18n="[html]index.intro_section.arg4"></span><br>
                    </p><br>
                </div>
                <div class="box-wrap clearfix"></div>
                <p style="col-md-12">
                    <a class="btn btn-success enter_button i18n" style="margin: 5px;" data-i18n="[html]index.buttons.enter"></a>
                    <a id="resume_btn" class="btn btn-success i18n" disabled style="margin: 5px;" data-i18n="[html]index.buttons.resume"></a>
                </p>
            </div>
        </div>
        <div class="end_div_divider col-lg-8 img-responsive" style="background-image:url('/static/img/divider_europe_1843_wikimedia.png');"></div>

    </section>

    <section id="overview" class="overview-section">
        <div class="container">
            <div class="row">
            <h1 style="font-family:Dosis;" class="i18n" data-i18n="[html]index.buttons.overview"></h1>
            <hr class="grad-transp"></hr>
                <div class="col-md-6">
                    <p style="text-align:left;">
                        <strong><span class="i18n" data-i18n="[html]index.overview_section.list_func1"></span></strong><br>
                        <span class="i18n" data-i18n="[html]index.overview_section.list_func2"></span><br><br>
                        <strong><span class="i18n" data-i18n="[html]index.overview_section.import1"></span></strong><br>
                        <span class="i18n" data-i18n="[html]index.overview_section.import2"></span><br><br>
                        <strong><span class="i18n" data-i18n="[html]index.overview_section.customize1"></span></strong><br>
                        <span class="i18n" data-i18n="[html]index.overview_section.customize2"></span>
                    </p>
                </div>
                <div class="col-md-6">
                    <p style="text-align:left;">
                        <strong><span class="i18n" data-i18n="[html]index.overview_section.export1"></span></strong><br>
                        <span class="i18n" data-i18n="[html]index.overview_section.export2"></span><br><br>
                        <strong><span class="i18n" data-i18n="[html]index.overview_section.export_geo1"></span></strong><br>
                        <span class="i18n" data-i18n="[html]index.overview_section.export_geo2"></span><br><br>
                        <strong><em><span class="i18n" data-i18n="[html]index.overview_section.conclusion"></span></strong></em>
                    </p>
                </div>
            <img src='/static/img/abc.png' alt='Everyone happy' style="max-height: 120px">
            </div>
        </div>
    </section>

    <section id="examples" class="examples-section">
        <div class="container">
            <div class="row">
            <h1 style="font-family:Dosis;" class="i18n" data-i18n="[html]index.buttons.examples"></h1>
            <hr class="grad-transp"></hr>
                <div class="col-md-3">
                    <a class="pop">
                    <img class="img-responsive center-block" data-toggle="popover" data-placement="auto" title="Choropleth map" src="/static/img/gallery/choropleth_map.png" alt="Choropleth map" style="max-height:100px;cursor:pointer;">
                    </a>
                </div>
                <div class="col-md-3">
                    <a class="pop">
                    <img class="img-responsive center-block" data-toggle="popover" data-placement="auto" title="Smoothed map" src="/static/img/gallery/smoothed.png" alt="Smoothed map" style="max-height:100px;cursor:pointer;">
                    </a>
                </div>
                <div class="col-md-3">
                    <a class="pop">
                    <img class="img-responsive center-block" data-toggle="popover" data-placement="auto" title="Discontinuity map" src="/static/img/gallery/discont.png" alt="Discontinuity map" style="max-height:100px;cursor:pointer;">
                    </a>
                </div>

                <div class="col-md-3">
                    <a class="pop">
                    <img class="img-responsive center-block" data-toggle="popover" data-placement="auto" title="Density map" src="/static/img/gallery/gridded.png" alt="Density map" style="max-height:100px;cursor:pointer;">
                    </a>
                </div>
                <div class="col-md-12" style="height:20px">
                    <p> </p>
                </div>
                <div class="col-md-6">
                    <a class="pop">
                    <img class="img-responsive center-block" data-toggle="popover" data-placement="auto" title="Proportional symbols map" src="/static/img/gallery/propsymbols.png" alt="Proportional symbols map" style="max-height:100px;cursor:pointer;">
                    </a>
                </div>

                <div class="col-md-6">
                    <a class="pop">
                    <img class="img-responsive center-block" data-toggle="popover" data-placement="auto" title="Flows/links map" src="/static/img/gallery/flows.png" alt="Flows/links map" style="max-height:100px;cursor:pointer;">
                    </a>
                </div>


                <div class="col-md-12">
                    <p style="margin-top: 25px;" class="i18n" data-i18n="[html]index.examples_section.gallery"></p>
                </div>
            </div>
        </div>
    </section>

    <section id="projections" class="projections-section">
        <div class="container">
            <!-- <div class="row"> -->
            <h1 style="font-family:Dosis;" class="i18n" data-i18n="[html]index.buttons.projections"></h1>
            <hr class="grad-transp"></hr>

            <div id="myCarousel" class="carousel slide col-md-12" data-ride="carousel">
              <!-- Indicators -->
              <ol class="carousel-indicators">
                <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
                <li data-target="#myCarousel" data-slide-to="1"></li>
                <li data-target="#myCarousel" data-slide-to="2"></li>
                <li data-target="#myCarousel" data-slide-to="3"></li>
              </ol>

                  <!-- Wrapper for slides -->
                  <div class="carousel-inner" role="listbox">
                    <div class="item active">
                      <img src="/static/img/gallery/proj_armadillo.png" alt="Armadillo">
                      <div class="carousel-caption">
                        <h3>Armadillo projection</h3>
                        <p>Projection description 1.</p>
                      </div>
                    </div>

                    <div class="item">
                      <img src="/static/img/gallery/proj_peirce.png" alt="Peirce">
                      <div class="carousel-caption">
                        <h3>Peirce</h3>
                        <p>Projection description 2.</p>
                      </div>
                    </div>

                    <div class="item">
                      <img src="/static/img/gallery/proj_interrupted.png" alt="Interrupted">
                      <div class="carousel-caption">
                        <h3>Interrupted</h3>
                        <p>Projection description 3.</p>
                      </div>
                    </div>

                    <div class="item">
                      <img src="/static/img/gallery/proj_bonne.png" alt="Bonne">
                      <div class="carousel-caption">
                        <h3>Bonne</h3>
                        <p>Projection description 4.</p>
                      </div>
                    </div>
                  </div>
                    <a class="left carousel-control" href="#myCarousel" role="button" data-slide="prev" style="background-image:none;">
                      <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
                      <span class="sr-only">Previous</span>
                    </a>
                    <a class="right carousel-control" href="#myCarousel" role="button" data-slide="next" style="background-image:none;">
                      <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
                      <span class="sr-only">Next</span>
                    </a>
                </div> <!-- /#myCarousel> -->

            <!-- </div> -->
        </div>
    </section>


    <section id="documentation" class="documentation-section">
        <div class="container">
            <div class="row">
            <h1 style="font-family:Dosis;" class="i18n" data-i18n="[html]index.buttons.doc"></h1>
            <hr class="grad-transp"></hr>
                <div class="col-lg-12">
                        <p class="i18n" data-i18n="[html]index.documentation_section.intro"></p>
                </div>
            </div>
        </div>
    </section>

    <section id="source" class="source-section">
        <div class="container">
            <div class="row">
            <h1 style="font-family:Dosis;" class="i18n" data-i18n="[html]index.buttons.dev"></h1>
            <hr class="grad-transp"></hr>
                <div class="col-lg-3 col-md-6 text-center">
                    <div class="box1">
                        <img src="/static/img/opensource_initiative.png" style="max-height:60px;" alt="OpenSource Initiative">
                        <h3 class="i18n" data-i18n="[html]index.source_section.box1_title"></h3>
                        <p class="i18n" data-i18n="[html]index.source_section.box1_text"></p>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6 text-center">
                    <div class="box1">
                        <img src="/static/img/Octicons-mark-github.svg" style="max-height:60px;">
                        <h3 class="i18n" data-i18n="[html]index.source_section.box2_title"></h3>
                        <p class="i18n" data-i18n="[html]index.source_section.box2_text"></p>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6 text-center">
                    <div class="box1">
                        <img src="/static/img/i18next_logo.png" style="max-height:60px;" alt="Traductible content">
                        <h3 class="i18n" data-i18n="[html]index.source_section.box3_title"></h3>
                        <p class="i18n" data-i18n="[html]index.source_section.box3_text"></p>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6 text-center">
                    <div class="box1">
                        <img src="/static/img/Schlaegel_und_Eisen_nach_DIN_21800.svg" style="max-height:60px;" alt="Fork me on github">
                        <h3 class="i18n" data-i18n="[html]index.source_section.box4_title"></h3>
                        <p class="i18n" data-i18n="[html]index.source_section.box4_text"></p>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <footer id="footer">
        <div class="container">
            <div class="row">
                <div class="col-lg-3"></div>
                <div class="col-lg-3">
                    <a href="http://riate.cnrs.fr"><img src="/static/img/logo_riate.svg" alt="RIATE logo" style="max-height:18px;"></a>
                </div>
                <div class="col-lg-3">

                </div>
                <div class="col-lg-3">

                </div>
            </div>
        </div>
    </footer>
<div class="modal fade" id="imagemodal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-body">
      	<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <img src="" class="imagepreview" style="width: 100%;" >
      </div>
    </div>
  </div>
</div>
<div style="box-shadow:0em 0em 1em black;position:fixed;left:50%;transform:translateX(-50%);font-size:14px;width:auto;bottom:0px;opacity:0.85;text-align:center;background-color:black;color:white;padding:0.5em;" id="cookieLaw">
    <span class="i18n" data-i18n="index.cookie_div.message"></span><br>
    <span id="understood_cookie" class="i18n" style="line-height: 1.7em; cursor:pointer;border-radius: 0.4em;background-color:#4BA5FC;color:white;margin-left:1em;margin-right:1em;padding:0.2em;padding-left:1em;padding-right:1em;" data-i18n="index.cookie_div.accept">I understand</span>
    <a style="color:#4BA5FC" href="/about/#cookie" class="i18n" data-i18n="index.cookie_div.more_info"></a>
</div>
{% raw %}
<script>
//jQuery for initialising tooltips
$('[data-toggle="popover"]').popover({
    trigger: 'hover'
});

//jQuery for image preview
$(function(){
    $(".pop").on("click", function(){
        $(".imagepreview").attr("src", $(this).find("img").attr("src"));
        $("#imagemodal").modal("show");
    });
});

//jQuery to collapse the navbar on scroll
$(window).scroll(function() {
    if ($(".navbar").offset().top > 50) {
        $(".navbar-fixed-top").addClass("top-nav-collapse");
    } else {
        $(".navbar-fixed-top").removeClass("top-nav-collapse");
    }
});

//jQuery for page scrolling feature - requires jQuery Easing plugin
$(function() {
    $('a.page-scroll').bind('click', function(event) {
        var $anchor = $(this);
        $('html, body').stop().animate({
            scrollTop: $($anchor.attr('href')).offset().top
        }, 1500, 'easeInOutExpo');
        event.preventDefault();
    });
});

//Handle user click on the "language" buttons :
function handle_change_lang(){
    if(this.id == "lang1" && i18next.language == this.innerHTML){
        return;
    }
    let lang = this.innerHTML,
        old_lang = document.getElementById("lang_current").innerHTML;
    change_lang(lang, old_lang);
}

// Actually change the content of the page :
function change_lang(new_lang, old_lang){
    i18next.changeLanguage(new_lang, () => { localize(".i18n");});
    document.getElementById("lang_current").innerHTML = new_lang;
    document.getElementById("lang2").innerHTML = old_lang;
    document.getElementById("lang1").innerHTML = new_lang;
}


function bind_enter_buttons(){
    let enter = () => {
        if(!docCookies.getItem("cookie_law_validated")){
            docCookies.setItem("cookie_law_validated", "true", 31536e3, "/");
        }
        window.location = "/modules?lang=" + i18next.language;
    };
    let elems = document.querySelectorAll(".enter_button");
    for(let i=0; i < elems.length; i++){
        elems[i].onclick = enter;
    }
    if(window.localStorage.getItem("noname_map_project")){
        let resume_btn = document.getElementById("resume_btn");
        resume_btn.removeAttribute("disabled");
        resume_btn.onclick = function(){
                 window.location = "/modules?resume?lang=" + i18next.language;
            }
    }
}


function handle_div_cookie(){
    let cookie_div = document.getElementById("cookieLaw");
    if(docCookies.getItem("cookie_law_validated")){
        cookie_div.style.display = "none";
    } else {
        cookie_div.querySelector("#understood_cookie")
            .onclick = () => {
                document.getElementById("cookieLaw").remove();
                docCookies.setItem("cookie_law_validated", "true", 31536e3, "/");
            };
    }
}


function prepare_lang_buttons(){
    let current_lang =  i18next.language,
        other_lang = current_lang == "en" ? "fr" : "en";
    document.getElementById("lang_current").innerHTML = current_lang;
    let button_lang1 = document.getElementById("lang1");
    button_lang1.innerHTML = current_lang;
    button_lang1.onclick = handle_change_lang;
    let button_lang2 = document.getElementById("lang2");
    button_lang2.innerHTML = other_lang;
    button_lang2.onclick = handle_change_lang;
}

//i18n initialization :
(function(){
    var existing_lang = ["en", "fr"]
    let lang = window.navigator.language.split('-')[0];
    lang = existing_lang.indexOf(lang) > -1 ? lang : 'en';
    i18next.use(i18nextXHRBackend)
      .init({
          debug: true,
          lng: lang,
          fallbackLng: existing_lang[0],
          backend: {
            loadPath: "/static/locales/{{lng}}/translation.json"
          }
    }, (err, t) => {
        if(err)
            throw err;
        else {
            window.localize = locI18next.init(i18next);
            localize(".i18n");
            bind_enter_buttons();
            handle_div_cookie();
            prepare_lang_buttons();
        }
    });
})();

</script>
{% endraw %}
</body>
</html>
